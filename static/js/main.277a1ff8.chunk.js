(this["webpackJsonpreact-amazing-map"]=this["webpackJsonpreact-amazing-map"]||[]).push([[0],{10:function(e,t,n){e.exports={wrap:"GoogleMap_wrap__x_6vF",head:"GoogleMap_head__A-WvM",item:"GoogleMap_item__30zOT",map:"GoogleMap_map__1K5Sh"}},11:function(e,t,n){e.exports={point:"Point_point__17pKl",name:"Point_name__2HocH",hovered:"Point_hovered__3pEGT",active:"Point_active__1DbOg"}},14:function(e,t,n){e.exports={route:"Route_route__3QzlB",list:"Route_list__dMC8H",item:"Route_item__1zFDd"}},27:function(e,t,n){},35:function(e,t,n){"use strict";n.r(t);var i=n(0),o=n.n(i),r=n(12),a=n.n(r),c=(n(27),n(2)),s=n(22),l=n(10),u=n.n(l),d=n(7),h=n(8),p=n(18),m=n(19),f=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.onMarkerHover,o=n.onMarkerClick;Object(d.a)(this,e),this.loader=new p.a({apiKey:"AIzaSyBOMQAKjVaaYfe_fSHNn3CBFcbNS651GnA",version:"weekly"}),this.map=null,this.mapContainer=document.querySelector(t),this.mapOptions={zoom:6,center:{lat:49.30881846,lng:30.53801849},clickableIcons:!1,zoomControl:!0,mapTypeControl:!1,scaleControl:!0,streetViewControl:!1,rotateControl:!1,fullscreenControl:!0,scrollwheel:!0},this.markers=[],this.infoWindows=[],this.route=null,this.circle=null,this.cluster=null,this.onMarkerHover=i,this.onMarkerClick=o}return Object(h.a)(e,[{key:"setMarkers",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.clearMarkers(),t.forEach((function(t,n){var i=e.createMarker(t);e.markers.push(i),e.cluster.setPoint(t),e.createInfoWindow(t),e.addMarkerListeners(i,n)})),this.cluster.group(this.markers),this.centeredMap()}},{key:"createMarker",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n={position:{lat:+e.coordinates.lat,lng:+e.coordinates.lng},zIndex:10};t&&(n.map=this.map);var i=new google.maps.Marker(n);return i}},{key:"handleCreateMarker",value:function(e){var t=this.createMarker(e,!0);t.setZIndex(9),this.markers.push(t),this.circle.show(t)}},{key:"removeLastMarker",value:function(){this.markers[this.markers.length-1].setMap(null),this.circle.hide()}},{key:"centeredMap",value:function(){return this.markers.length>1?(this.map.fitBounds(this.cluster.bounds),void this.rebotMapZoom()):1===this.markers.length?(this.map.setCenter(this.markers[0].getPosition()),void this.map.setZoom(14)):(this.map.setCenter(this.mapOptions.center),void this.map.setZoom(this.mapOptions.zoom))}},{key:"rebotMapZoom",value:function(){var e=this,t=this.map.getZoom();this.map.setZoom(t-1),setTimeout((function(){e.map.setZoom(t)}),0)}},{key:"createInfoWindow",value:function(e){var t,n='\n    <div class="map-window">\n      <div class="map-window-img">\n        <img src="'.concat((t=e).image||"https://via.placeholder.com/100x50/000000/FFFFFF/?text=img",'" alt="').concat(t.name,'">\n      </div>\n      <div class="map-window-content">\n        <h2 class="map-window-title">\n          ').concat(t.name,"\n        </h2>\n      </div>\n    </div>\n  "),i=new google.maps.InfoWindow({content:n});this.infoWindows.push(i)}},{key:"addMarkerListeners",value:function(e,t){var n=this;e.addListener("click",(function(){n.toggleInfoWindow(e,t),"function"===typeof n.onMarkerClick&&n.onMarkerClick(t)})),e.addListener("mouseover",(function(){n.circle.show(e),"function"===typeof n.onMarkerHover&&n.onMarkerHover(t)})),e.addListener("mouseout",(function(){n.circle.hide(),"function"===typeof n.onMarkerHover&&n.onMarkerHover(null)}))}},{key:"addMapListeners",value:function(){var e=this;this.map.addListener("click",(function(){e.closeAllInfoWindows()}))}},{key:"toggleInfoWindow",value:function(e,t){this.infoWindows[t].getMap()?this.infoWindows[t].close():(this.closeAllInfoWindows(),this.infoWindows[t].open(this.map,e))}},{key:"closeAllInfoWindows",value:function(){var e=this;this.infoWindows.forEach((function(t,n){e.infoWindows[n].close()}))}},{key:"clearMarkers",value:function(){var e=this;this.cluster.clear(),this.route.clear(),this.markers.forEach((function(t,n){e.markers[n].setMap(null)})),this.markers=[],this.infoWindows=[]}},{key:"handleClickMarker",value:function(e){google.maps.event.trigger(this.markers[e],"click")}},{key:"handleMarkerMouseover",value:function(e){google.maps.event.trigger(this.markers[e],"mouseover")}},{key:"handleMarkerMouseout",value:function(e){google.maps.event.trigger(this.markers[e],"mouseout")}},{key:"init",value:function(){var e=this;return new Promise((function(t,n){e.loader.load().then((function(){return e.map=new google.maps.Map(e.mapContainer,e.mapOptions),e.addMapListeners(),e.circle=new j(e.map),e.route=new g(e.map),e.cluster=new v(e.map),t()})).catch((function(e){return console.log("GoogleMap init error:",e),n()}))}))}}]),e}(),v=function(){function e(t){Object(d.a)(this,e),this.markerCluster=null,this.bounds=null,this.map=t}return Object(h.a)(e,[{key:"group",value:function(e){this.markerCluster=new m.a(this.map,e,{imagePath:"https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/m"})}},{key:"setPoint",value:function(e){this.init(),this.bounds.extend({lat:+e.coordinates.lat,lng:+e.coordinates.lng})}},{key:"clear",value:function(){null!==this.markerCluster&&(this.bounds=null,this.markerCluster.clearMarkers())}},{key:"init",value:function(){null===this.bounds&&(this.bounds=new google.maps.LatLngBounds)}}]),e}(),g=function(){function e(t){Object(d.a)(this,e),this.directionsService=null,this.directionsRenderer=null,this.map=t,this.init()}return Object(h.a)(e,[{key:"draw",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(t.length&&!(t.langth<2)){this.directionsRenderer.setMap(this.map);var n={origin:(t=t.map((function(t){return e.createWaypoint(t)})))[0].location,destination:t[t.length-1].location,optimizeWaypoints:!0,travelMode:google.maps.TravelMode.DRIVING};t.length>2&&(n.waypoints=t.splice(1,t.length-2)),this.directionsService.route(n,(function(t,n){"OK"===n&&t?e.directionsRenderer.setDirections(t):window.alert("Directions request failed due to "+n)}))}}},{key:"createWaypoint",value:function(e){var t=e.coordinates?+e.coordinates.lat:e.getPosition().lat(),n=e.coordinates?+e.coordinates.lng:e.getPosition().lng();return{location:new google.maps.LatLng(t,n),stopover:!1}}},{key:"clear",value:function(){this.directionsRenderer.setMap(null)}},{key:"init",value:function(){this.directionsService=new google.maps.DirectionsService,this.directionsRenderer=new google.maps.DirectionsRenderer({suppressMarkers:!0,preserveViewport:!0})}}]),e}(),j=function(){function e(t){Object(d.a)(this,e),this.options={zIndex:2,visible:!1,position:{lat:46.64288927,lng:31.07230514},icon:{path:google.maps.SymbolPath.CIRCLE,fillColor:"green",fillOpacity:.15,strokeColor:"green",strokeOpacity:.8,strokeWeight:1,scale:20,anchor:new google.maps.Point(0,.8),zIndex:2},map:t},this.circle=new google.maps.Marker(this.options)}return Object(h.a)(e,[{key:"show",value:function(e){var t=e.getPosition();this.circle.setPosition(t),this.circle.setVisible(!0)}},{key:"hide",value:function(){this.circle.setVisible(!1)}}]),e}(),b=n(4),k=n(6),O=n(5),M=Object(b.a)(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:9;return Object(b.a)(Array(t)).map((function(t,n){return(e=JSON.parse(JSON.stringify(e))).hasOwnProperty("coordinates")&&(e.coordinates.lat-=Math.random()/100,e.coordinates.lng-=Math.random()/100),Object(O.a)(Object(O.a)({},e),{},{_id:"".concat(e._id,"_").concat(n),name:"".concat(e.name," ").concat(n)})}))}({_id:"id:point",type:"point",name:"point name",coordinates:{lat:46.454428,lng:30.739338}},5)),w=Object(k.b)({name:"detailIngredient",initialState:{points:Object(b.a)(M),activePoint:null,hoveredPoint:null},reducers:{setActivePoint:function(e,t){e.activePoint=t.payload},setHoveredPoint:function(e,t){e.hoveredPoint=t.payload},setFiltredPoints:function(e,t){e.filtredPoints=Object(b.a)(t.payload)}}}),y=w.actions,x=y.setHoveredPoint,_=y.setActivePoint,C=function(e){return e.point},P=w.reducer,I=Object(k.b)({name:"detailIngredient",initialState:{route:[]},reducers:{addPointToRoute:function(e,t){e.route.push(t.payload)},removePointFromRoute:function(e,t){e.route=Object(b.a)(e.route).filter((function(e){return e._id!==t.payload._id}))},clearRoute:function(e){e.route=[]}}}),W=I.actions,R=W.addPointToRoute,L=W.removePointFromRoute,S=W.clearRoute,F=function(e){return e.route},N=I.reducer,z=n(1),H=function(){var e=Object(c.b)(),t=Object(c.c)(C),n=t.points,o=t.activePoint,r=t.hoveredPoint,a=Object(c.c)(F).route,l=function(e){var t=Object(i.useRef)();return Object(i.useEffect)((function(){t.current=e})),{previous:t.current,current:e}}(r),d=l.previous,h=l.current,p=Object(i.useState)(null),m=Object(s.a)(p,2),v=m[0],g=m[1];Object(i.useEffect)((function(){var t=new f("#map",{onMarkerClick:function(t){e(_(t))},onMarkerHover:function(t){e(x(t))}});t.init().then((function(){t.setMarkers(n)})),g(t)}),[]),Object(i.useEffect)((function(){v&&v.setMarkers(n)}),[n]),Object(i.useEffect)((function(){v&&(null===d||null!==h?null!==d||null===h||v.handleCreateMarker(n[r]):v.removeLastMarker())}),[r]),Object(i.useEffect)((function(){v&&(a.length||v.route.clear(),v.route.draw(a))}),[a]);return Object(z.jsxs)("div",{className:u.a.wrap,children:[Object(z.jsxs)("div",{className:u.a.head,children:[Object(z.jsxs)("div",{children:[Object(z.jsx)("h2",{children:"Google map"}),Object(z.jsxs)("p",{children:["active: ",o]}),Object(z.jsxs)("p",{children:["hovered: ",r]}),Object(z.jsx)("button",{onClick:function(){v.centeredMap()},children:"centeredMap"})]}),null!==o&&Object(z.jsxs)("div",{className:u.a.item,children:[Object(z.jsx)("p",{children:n[o].name}),Object(z.jsx)("button",{onClick:function(){e(_(null))},children:"close"})]})]}),Object(z.jsx)("div",{id:"map",className:u.a.map})]})},E=n(20),A=n(11),T=n.n(A),D=["point","index"],G=function(e){var t=Object(c.b)(),n=e.point,i=e.index,o=Object(E.a)(e,D),r=Object(c.c)(C),a=r.activePoint,s=r.hoveredPoint;return Object(z.jsxs)("div",Object(O.a)(Object(O.a)({},o),{},{className:"\n        ".concat(T.a.point,"\n        ").concat(a===i?T.a.active:"","\n        ").concat(s===i?T.a.hovered:"","\n      "),children:[Object(z.jsx)("span",{className:T.a.name,children:n.name}),Object(z.jsx)("button",{onClick:function(e){e.stopPropagation(),t(R(n))},children:"add to route"})]}))},Z=function(){var e=Object(c.c)(C),t=e.points,n=e.activePoint,i=Object(c.b)();return Object(z.jsxs)("div",{style:{minWidth:200,marginRight:20},children:[t.map((function(e,t){return Object(z.jsx)(G,{point:e,index:t,onMouseEnter:function(){return i(x(t))},onMouseLeave:function(){return i(x(null))},onClick:function(){return i(_(t))}},e._id)})),null!==n&&Object(z.jsx)("button",{onClick:function(){return i(_(null))},children:"Clear active"})]})},B=n(14),V=n.n(B),K=function(){var e=Object(c.b)(),t=Object(c.c)(F).route;return Object(z.jsxs)("div",{className:V.a.route,children:[Object(z.jsx)("ul",{className:V.a.list,children:t.map((function(t){return Object(z.jsxs)("li",{className:V.a.item,style:{display:"flex",flexDirection:"column"},children:[t.name,Object(z.jsx)("button",{style:{marginTop:10},onClick:function(){e(L(t))},children:"remove"})]},t._id)}))}),Object(z.jsx)("button",{onClick:function(){e(S())},children:"clear route"})]})},J=function(){var e=Object(c.c)(F).route;return Object(z.jsxs)("div",{children:[0!==e.length&&Object(z.jsx)(K,{}),Object(z.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[Object(z.jsx)(Z,{}),Object(z.jsx)(H,{})]})]})},q=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,36)).then((function(t){var n=t.getCLS,i=t.getFID,o=t.getFCP,r=t.getLCP,a=t.getTTFB;n(e),i(e),o(e),r(e),a(e)}))},Q=n(21),Y=Object(k.b)({name:"detailIngredient",initialState:{categories:[],places:[]},reducers:{}});Object(Q.a)(Y.actions);var U=Y.reducer,X=Object(k.a)({reducer:{point:P,route:N,location:U}});a.a.render(Object(z.jsx)(o.a.StrictMode,{children:Object(z.jsx)(c.a,{store:X,children:Object(z.jsx)(J,{})})}),document.getElementById("root")),q()}},[[35,1,2]]]);
//# sourceMappingURL=main.277a1ff8.chunk.js.map